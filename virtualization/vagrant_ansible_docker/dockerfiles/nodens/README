The files in this directory are used to build a docker image that executes the
nodens server created by Oscar Renalias. It sets up a node runtime environment,
check the project out from https://github.com/oscarrenalias/nodens and builds it.
Supervisor is then used to start rsyslogd, sshd (in port 22) and nodens.

The image can be built with:

	sudo docker build -t <imagename> .

Check out the nodens documentation for how to use it. Running the created docker
image can be for example:

	sudo docker run -p 10022:22 -p 8053:8053 <imagename>

Then assuming that the docker runs in IP 10.10.10.30 the dns server can be tested
by running:

	curl -X PUT -H "Content-Type: application/json" http://10.10.10.30:8053/lo -d '{ "address": "1.2.3.4", "name": "www.test.com", "ttl": "10", "expires": "3600", "type": 1 }'

The command should return OK indicating that the address has been added to the repository.

There is a shell file included which starts the server and uses pipeworks to set up
internal networking. Pipeworks needs to be installed, if it isn't, enter the command:

	git clone https://github.com/jpetazzo/pipework.git

Then create a link to the script file so that it's visible globally:

	sudo ln pipework/pipework /usr/local/bin/pipework

Then the server with the internal networking can be started with:

	bash startNodens.sh

Now the server should be testable from another docker image which has the networking also set up
by using the dig command (you might need to install it first):

	apt-get install dnsutils
	dig @10.1.1.1 -p 15353 www.test.com

The riak docker configuration includes a script that starts the riak dock and then registers itself
with the dns server with the name 1.riak.local. The image itself has the nodens as the only DNS server
and the system can be tested from there with for example:

	curl 1.riak.local:8098

Note: At the moment the upstream lookup hasn't been enabled in this nodens configuration, so trying
to install packages in the riak image at the moment fails unless multiple DNS servers are configured
on the command line in the script.

The docker image is reachable through ssh and the root password is "nodens", the shell script
exposes the ssh port as 1001.

The node logs can be found from /var/log/supervisor/node.log.
